<!doctype html>
<html lang="cs">
<head>
  <!-- ... (stejn√Ω head jako v p≈Øvodn√≠m souboru) ... -->
  <!-- Z d≈Øvodu d√©lky nen√≠ zde cel√Ω style blok, pouze zmƒõny v JS a ƒç√°sti HTML -->
  <!-- Zkop√≠ruj si sv≈Øj p≈Øvodn√≠ style blok beze zmƒõn -->
</head>
<body>
  <div class="app" id="app">
    <aside id="sidebar">
      <div class="brand">
        <i>üè†</i>
        <strong>Aplikace pronaj√≠matel</strong>
      </div>
      <div class="search"><input id="q" placeholder="Hledat‚Ä¶ (dla≈ædice i osnova)" /></div>
      <div id="nav"></div>
      <div class="mini">Klik na sekci = otev≈ôe panel sekce. Klik na polo≈æku (nap≈ô. Seznam pronaj√≠matel≈Ø) = otev≈ôe rovnou seznam.</div>
    </aside>
    <div style="display:flex; flex-direction:column">
      <header>
        <div class="left" style="display:flex; align-items:center; gap:10px">
          <button class="btn ghost menu" id="openMenu">‚ò∞</button>
          <div class="breadcrumbs" id="crumbs">
            <span class="crumb">Hlavn√≠ panel</span>
          </div>
        </div>
        <div class="actions">
          <button class="btn" id="backHome" style="display:none">‚Üê Zpƒõt</button>
          <button class="btn" id="resetFilter">Zru≈°it filtr</button>
          <button class="btn primary" id="addTile">+ P≈ôidat dla≈ædici</button>
        </div>
      </header>
      <main id="main"></main>
    </div>
  </div>

  <!-- Drawer: Pronaj√≠matel (CRUD) -->
  <div class="overlay" id="overlayPronaj"></div>
  <div class="drawer" id="drawerPronaj">
    <header>
      <div style="display:flex; align-items:center; justify-content:space-between; padding:10px 14px">
        <strong id="drawerPronajTitle">Nov√Ω pronaj√≠matel</strong>
        <button class="btn" id="closeDrawerPronaj">‚úï</button>
      </div>
    </header>
    <div class="body">
      <div class="row" style="display:grid; grid-template-columns:1fr 1fr; gap:10px">
        <div>
          <label for="pjmeno">Jm√©no</label>
          <input id="pjmeno" class="input" />
        </div>
        <div>
          <label for="ptelefon">Telefon</label>
          <input id="ptelefon" class="input" />
        </div>
      </div>
      <div class="row" style="display:grid; grid-template-columns:1fr 1fr; gap:10px">
        <div>
          <label for="pemail">E‚Äëmail</label>
          <input id="pemail" class="input" />
        </div>
        <div>
          <label for="pfirma">Firma / organizace</label>
          <input id="pfirma" class="input" placeholder="nap≈ô. OSVƒå, s.r.o." />
        </div>
      </div>
      <div style="display:flex; gap:10px; margin-top:6px">
        <button class="btn" id="savePronaj">Ulo≈æit</button>
      </div>
    </div>
  </div>

  <!-- Drawer: N√°jemn√≠k (CRUD) ... (p≈Øvodn√≠ z≈Øst√°v√°) -->

  <script>
    (function(){
      document.addEventListener('DOMContentLoaded', init);
      function init(){
        const state = {
          sections: [
            { id: 'pronajimatele', title: 'Pronaj√≠matel√©', open: true, items: [
              { id: 'seznam-pronajimatelu', title: 'Seznam pronaj√≠matel≈Ø', tag: 'pronajimatele' }
            ]},
            // ... p≈Øvodn√≠ sekce z≈Øst√°vaj√≠ ...
            { id: 'nemovitosti', title: 'Nemovitosti', open: true, items: [
              { id: 'prehled-nemovitosti', title: 'P≈ôehled', tag: 'nemovitosti' },
              { id: 'jednotky', title: 'Jednotky / byty', tag: 'byty' },
              { id: 'budovy', title: 'Budovy', tag: 'budovy' },
              { id: 'volne', title: 'Voln√© jednotky', tag: 'volne' },
            ]},
            { id: 'najemnici', title: 'N√°jemn√≠ci', open: true, items: [
              { id: 'seznam-najemniku', title: 'Seznam n√°jemn√≠k≈Ø', tag: 'najemnici' },
              { id: 'smlouvy', title: 'Smlouvy', tag: 'smlouvy' },
              { id: 'ukonceni', title: 'Ukonƒçen√≠ n√°jm≈Ø', tag: 'ukonceni' },
            ]},
            // ... ostatn√≠ sekce ...
          ],
          tiles: [
            { id: 'tp1', icon: 'üßë‚Äçüíº', title: 'Pronaj√≠matel√©', desc: 'Seznam pronaj√≠matel≈Ø', tags: ['pronajimatele'] },
            // ... p≈Øvodn√≠ dla≈ædice ...
            { id: 't1', icon: 'üè¢', title: 'Byty ‚Äì p≈ôehled', desc: 'Souhrn jednotek, obsazenost, n√°jemn√©', tags: ['byty','nemovitosti'] },
            // ... ostatn√≠ dla≈ædice ...
          ],
          pronajimatele: [
            { id: 'p1', jmeno: 'Karel Dvo≈ô√°k', email: 'karel.dvorak@example.cz', telefon: '+420 777 888 999', firma: 'OSVƒå' }
          ],
          najemnici: [
            { id: 'n1', jmeno: 'Jan Nov√°k', email: 'jan.novak@example.cz', telefon: '+420 777 111 222', byt: '2+kk, Revoluƒçn√≠ 12' },
            { id: 'n2', jmeno: 'Petra Svobodov√°', email: 'p.svobodova@example.cz', telefon: '+420 602 333 444', byt: '1+1, Dlouh√° 8' },
          ],
          view: { mode: 'home', sectionId: null, listId: null },
          editId: null,
          tenantEditId: null,
          pronajEditId: null,
        };

        // ... v≈°echny p≈Øvodn√≠ helpers a renderNav, renderMain, atd... z≈Øst√°vaj√≠ ...

        function renderMain(){
          const main = $('#main');
          main.innerHTML = '';
          const mode = state.view.mode;

          if (mode === 'home') {
            const grid = el('div', { class:'grid' });
            state.tiles.forEach(t => {
              grid.appendChild(tileEl(t));
            });
            main.appendChild(grid);
            return;
          }

          if (mode === 'section') {
            const sec = state.sections.find(s=>s.id===state.view.sectionId);
            if (!sec) { main.textContent = 'Sekce nenalezena'; return; }
            // ... (zbytek z≈Øst√°v√° stejn√Ω)
          }

          // Nov√Ω modul: seznam pronaj√≠matel≈Ø
          if (mode === 'list' && state.view.listId === 'seznam-pronajimatelu') {
            renderPronajimatele(main);
            return;
          }

          // ... p≈Øvodn√≠ seznam n√°jemn√≠k≈Ø ...
          if (mode === 'list' && state.view.listId === 'seznam-najemniku') {
            renderNajemnici(main);
            return;
          }

          main.textContent = 'Obsah se p≈ôipravuje‚Ä¶';
        }

        function tileEl(t){
          // ... p≈Øvodn√≠ k√≥d dla≈ædice ...
          const tile = el('div', { class: 'tile' });
          tile.appendChild(el('div', { style:'display:flex; justify-content:space-between; align-items:center' }, [
            el('div', { class:'icon' }, [t.icon || 'üì¶']),
            el('div', { style: 'display:flex; gap:6px; flex-wrap:wrap' }, (t.tags||[]).map(x=>el('span', { class:'pill' }, ['#'+x])))
          ]));
          tile.appendChild(el('div', { class:'title' }, [t.title||'Bez n√°zvu']));
          tile.appendChild(el('div', { class:'desc', style:'color:var(--muted)' }, [t.desc || '']));
          tile.addEventListener('click', () => {
            if (t.tags.includes('pronajimatele')) setView('list', { listId: 'seznam-pronajimatelu' });
            else openEditor(t.id);
          });
          return tile;
        }

        // Pronaj√≠matel√© ‚Äì seznam a editor
        function renderPronajimatele(container){
          const tb = el('div', { class:'toolbar' }, [
            el('strong', {}, ['Seznam pronaj√≠matel≈Ø']),
            el('input', { id:'searchPronaj', class:'input', placeholder:'Hledat‚Ä¶' }, []),
            el('span', { class:'spacer' }, []),
            el('button', { class:'btn primary', onClick: () => openPronajEditor(null) }, ['+ P≈ôidat pronaj√≠matele'])
          ]);
          container.appendChild(tb);

          const tableWrap = el('div', { style:'padding: 0 18px 24px' });
          const table = el('table');
          const thead = el('thead'); const trh = el('tr');
          ['Jm√©no','E‚Äëmail','Telefon','Firma / organizace','Akce'].forEach(h=> trh.appendChild(el('th', {}, [h])));
          thead.appendChild(trh); table.appendChild(thead);
          const tbody = el('tbody');

          const q = () => ($('#searchPronaj')?.value || '').toLowerCase();
          const rows = () => state.pronajimatele.filter(n => Object.values(n).join(' ').toLowerCase().includes(q()));

          function renderRows(){
            tbody.innerHTML = '';
            rows().forEach(n => {
              const tr = el('tr');
              tr.appendChild(el('td', {}, [n.jmeno]));
              tr.appendChild(el('td', {}, [n.email]));
              tr.appendChild(el('td', {}, [n.telefon]));
              tr.appendChild(el('td', {}, [n.firma]));
              const tdA = el('td');
              const editBtn = el('button', { class:'btn', onClick: () => openPronajEditor(n.id) }, ['Upravit']);
              const delBtn = el('button', { class:'btn', style:'margin-left:6px; background:#2a1520; border-color:#3a1d2a', onClick: () => deletePronaj(n.id) }, ['Smazat']);
              tdA.appendChild(editBtn); tdA.appendChild(delBtn);
              tr.appendChild(tdA);
              tbody.appendChild(tr);
            });
          }
          renderRows();
          table.appendChild(tbody);
          tableWrap.appendChild(table);
          container.appendChild(tableWrap);

          const search = $('#searchPronaj');
          if (search) search.addEventListener('input', renderRows);
        }

        // Pronaj√≠matel drawer
        const overlayPronaj = $('#overlayPronaj');
        const drawerPronaj = $('#drawerPronaj');
        function openPronajEditor(id){
          state.pronajEditId = id;
          const n = id ? state.pronajimatele.find(x=>x.id===id) : { jmeno:'', email:'', telefon:'', firma:'' };
          $('#drawerPronajTitle').textContent = id ? 'Upravit pronaj√≠matele' : 'Nov√Ω pronaj√≠matel';
          $('#pjmeno').value = n.jmeno || '';
          $('#pemail').value = n.email || '';
          $('#ptelefon').value = n.telefon || '';
          $('#pfirma').value = n.firma || '';
          overlayPronaj.classList.add('show'); drawerPronaj.classList.add('open');
        }
        function closePronajEditor(){ overlayPronaj.classList.remove('show'); drawerPronaj.classList.remove('open'); }
        $('#closeDrawerPronaj').addEventListener('click', closePronajEditor);
        overlayPronaj.addEventListener('click', closePronajEditor);
        $('#savePronaj').addEventListener('click', () => {
          const jmeno = $('#pjmeno').value.trim();
          if (!jmeno) { alert('Zadej jm√©no.'); return; }
          const next = {
            jmeno,
            email: $('#pemail').value.trim(),
            telefon: $('#ptelefon').value.trim(),
            firma: $('#pfirma').value.trim(),
          };
          if (state.pronajEditId) {
            const idx = state.pronajimatele.findIndex(x=>x.id===state.pronajEditId);
            if (idx>=0) state.pronajimatele[idx] = { ...state.pronajimatele[idx], ...next };
          } else {
            state.pronajimatele.push({ id: 'p'+Date.now(), ...next });
          }
          closePronajEditor();
          if (state.view.mode==='list' && state.view.listId==='seznam-pronajimatelu') {
            renderMain();
          }
        });
        function deletePronaj(id){
          const idx = state.pronajimatele.findIndex(x=>x.id===id);
          if (idx>=0) state.pronajimatele.splice(idx,1);
          if (state.view.mode==='list' && state.view.listId==='seznam-pronajimatelu') {
            renderMain();
          }
        }

        // ... p≈Øvodn√≠ controls a inicializace z≈Øst√°vaj√≠ ...
        renderNav();
        setView('home');
      }
    })();
  </script>
</body>
</html>
