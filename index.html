<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Aplikace pronaj√≠matel ‚Äì Hlavn√≠ panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="src/forms/style-pronajimatel-najemnik.css">
  <style>
    :root {
      --bg: #0b0f14;
      --card: #121821;
      --muted: #99a3b3;
      --text: #e6edf3;
      --brand: #4cc9f0;
      --accent: #80ffdb;
      --border: #1c2430;
      --active: #21344a;
    }
    html, body { height: 100% }
    body {
      margin: 0; background: radial-gradient(1200px 800px at 70% -10%, rgba(128,255,219,0.09), transparent 50%),
                               radial-gradient(900px 600px at -10% 30%, rgba(76,201,240,0.08), transparent 50%), var(--bg);
      color: var(--text); font: 15px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial;
    }
    .app { display: grid; grid-template-columns: 270px 1fr; height: 100vh; }
    aside {
      background: linear-gradient(180deg, rgba(33,52,74,.4), rgba(18,24,33,.7) 30%), var(--card);
      border-right: 1px solid var(--border);
      padding: 12px 7px; overflow-y: auto;
    }
    .brand { display:flex; align-items:center; gap:8px; padding: 7px 10px; margin-bottom: 7px }
    .brand i { font-style: normal; font-size: 20px }
    .brand strong { letter-spacing:.3px }
    .section { margin: 10px 2px; border-radius:12px; overflow:hidden; border:1px solid var(--border); background: #0e141c }
    .section-header { display:flex; align-items:center; gap:8px; padding:7px 10px; cursor:pointer; user-select:none; font-size:15px }
    .section-items { display:block; padding:2px 2px 4px }
    .nav-item { display:flex; align-items:center; gap:7px; padding:4px 7px; margin:2px 1px; border-radius:8px; cursor:pointer; color:var(--muted); font-size:15px }
    .nav-item .icon { font-size:17px; }
    .nav-item:hover { background:#101826; color:var(--text) }
    .nav-item.active { background: var(--active); color: var(--text); border: 1px solid #243449 }
    .mini { font-size:12px; color:var(--muted); padding: 3px 12px 0 }
    header {
      display:flex; align-items:center; justify-content:space-between; padding: 13px 18px; position: sticky; top:0; background: linear-gradient(180deg, rgba(11,15,20,.96), rgba(11,15,20,.8)); backdrop-filter: blur(4px); border-bottom: 1px solid var(--border);
      z-index: 5;
    }
    .breadcrumbs { display:flex; gap:8px; align-items:center; color: var(--muted) }
    .breadcrumbs .crumb { padding:6px 10px; border-radius:999px; border:1px solid var(--border); background:#0e141c }
    .actions { display:flex; gap:8px; align-items:center }
    .btn {
      padding:8px 11px; border-radius:9px; border:1px solid var(--border); background: #101826; color:var(--text); cursor:pointer;
    }
    .btn.primary { background: linear-gradient(180deg, var(--brand), #183249 70%, #112336); border-color:var(--brand) }
    .btn.ghost { background: transparent }
    .btn:disabled { opacity:.5; cursor:not-allowed }
    main { height: 100vh; overflow: auto; }
    .grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(195px, 1fr)); gap: 13px; padding: 15px 16px 70px }
    .tile { position:relative; border:1px solid var(--border); border-radius:14px; padding:13px; background: linear-gradient(180deg, rgba(33,52,74,.28), rgba(16,24,38,.8)), var(--card); cursor:pointer; min-height:94px; display:flex; flex-direction:column; gap:9px; transition:box-shadow 0.15s }
    .tile .icon { font-size:26px; margin-bottom:1px }
    .tile .title { font-weight:600; display:flex; align-items:center; gap:7px; font-size:16px }
    .tile .desc { color:var(--muted); margin-bottom:2px; font-size:13px }
    .tile .pill { font-size:11px; padding:3px 6px; border-radius:999px; border:1px solid var(--border); color: var(--muted); background:#101826; margin-left:1px; }
    .tile:hover { outline:2px solid var(--brand); box-shadow:0 4px 24px 0 rgba(76,201,240,.09) }
    .list-table { width:100%; border-spacing:0; margin-bottom:30px }
    .list-table th, .list-table td { padding:6px 8px; border-bottom:1px solid var(--border); text-align:left }
    .list-table tr:hover { background:#101826 }
    .list-table th { color:var(--muted); background:#121821 }
    .list-actions { display:flex; gap:10px }
    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 100;
      left: 0; top: 0; right: 0; bottom: 0;
      background: rgba(30, 39, 50, 0.80);
      justify-content: center;
      align-items: center;
    }
    .modal.active { display: flex; }
    .modal-content {
      background: #161923;
      border-radius: 18px;
      box-shadow: 0 6px 32px 0 rgba(76,201,240,.17);
      padding: 38px 24px;
      min-width: 320px;
      max-width: 95vw;
      position: relative;
    }
    .modal-close {
      position: absolute;
      top: 22px;
      right: 32px;
      font-size: 1.4em;
      color: #4cc9f0;
      cursor: pointer;
    }
    @media (max-width: 900px) {
      .app { grid-template-columns: 1fr }
      aside { position: fixed; z-index: 30; width: 88%; max-width: 320px; inset: 0 auto 0 0; transform: translateX(-102%); transition: transform .25s ease }
      aside.open { transform: translateX(0) }
      header .menu { display:inline-flex }
    }
    @media (min-width: 901px) { header .menu { display:none } }
  </style>
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside id="sidebar">
      <div class="brand"><i>üè†</i><strong>Aplikace pronaj√≠matel</strong></div>
      <div id="nav"></div>
      <div class="mini">Klik na sekci = otev≈ôe panel sekce. Klik na polo≈æku = zobraz√≠ dla≈ædice nebo seznam.</div>
    </aside>
    <div style="display:flex; flex-direction:column">
      <!-- Header -->
      <header>
        <div class="left" style="display:flex; align-items:center; gap:10px">
          <button class="btn ghost menu" id="openMenu">‚ò∞</button>
          <div class="breadcrumbs" id="crumbs">
            <span class="crumb">Hlavn√≠ panel</span>
          </div>
        </div>
        <div class="actions">
          <button class="btn" id="backHome" style="display:none">‚Üê Zpƒõt</button>
          <button class="btn" id="resetFilter">Zru≈°it filtr</button>
          <button class="btn primary" id="addTile">+ P≈ôidat dla≈ædici</button>
        </div>
      </header>
      <!-- Main content -->
      <main id="main"></main>
    </div>
  </div>
  <!-- Modal okno pro formul√°≈ô -->
  <div class="modal" id="formModal">
    <div class="modal-content" id="modalContent">
      <span class="modal-close" id="modalClose">&times;</span>
      <div id="modalArea"></div>
    </div>
  </div>
  <script>
    // Ikony pro typy
    const typeIcons = {
      osoba: "üë§",
      osvc: "üßë‚Äçüíº",
      firma: "üè¢",
      spolek: "ü´Ç",
      stat: "üèõÔ∏è",
      zastupce: "üéì"
    };

    // Definice modul≈Ø (vƒçetnƒõ dla≈ædic)
    const modules = [
      {
        id: "pronajimatel",
        title: "Pronaj√≠matel",
        items: [
          { id: "prehled-pronajimatelu", menuTitle: "P≈ôehled", tileTitle: "V≈°ichni pronaj√≠matel√©", icon: "üßë‚Äçüíº", type: "all" },
          { id: "osoba-pronajimatel", menuTitle: "Osoba", tileTitle: "Osoba", icon: typeIcons.osoba, type: "osoba" },
          { id: "osvc-pronajimatel", menuTitle: "OSVƒå", tileTitle: "OSVƒå", icon: typeIcons.osvc, type: "osvc" },
          { id: "firma-pronajimatel", menuTitle: "Firma", tileTitle: "Firma", icon: typeIcons.firma, type: "firma" },
          { id: "spolek-pronajimatel", menuTitle: "Spolek / skupina", tileTitle: "Spolek / skupina", icon: typeIcons.spolek, type: "spolek" },
          { id: "stat-pronajimatel", menuTitle: "St√°tn√≠ instituce", tileTitle: "St√°tn√≠ instituce", icon: typeIcons.stat, type: "stat" },
          { id: "zastupce-pronajimatel", menuTitle: "Z√°stupce", tileTitle: "Z√°stupce", icon: typeIcons.zastupce, type: "zastupce" }
        ]
      },
      {
        id: "najemnici",
        title: "N√°jemn√≠ci",
        items: [
          { id: "prehled-najemniku", menuTitle: "P≈ôehled", tileTitle: "V≈°ichni n√°jemn√≠ci", icon: "üë§", type: "all" },
          { id: "osoba-najemnik", menuTitle: "Osoba", tileTitle: "Osoba", icon: typeIcons.osoba, type: "osoba" },
          { id: "osvc-najemnik", menuTitle: "OSVƒå", tileTitle: "OSVƒå", icon: typeIcons.osvc, type: "osvc" },
          { id: "firma-najemnik", menuTitle: "Firma", tileTitle: "Firma", icon: typeIcons.firma, type: "firma" },
          { id: "spolek-najemnik", menuTitle: "Spolek / skupina", tileTitle: "Spolek / skupina", icon: typeIcons.spolek, type: "spolek" },
          { id: "stat-najemnik", menuTitle: "St√°tn√≠ instituce", tileTitle: "St√°tn√≠ instituce", icon: typeIcons.stat, type: "stat" },
          { id: "zastupce-najemnik", menuTitle: "Z√°stupce", tileTitle: "Z√°stupce", icon: typeIcons.zastupce, type: "zastupce" }
        ]
      },
      {
        id: "nemovitosti",
        title: "Nemovitosti",
        items: [
          { id: "prehled-nemovitosti", menuTitle: "P≈ôehled", tileTitle: "P≈ôehled nemovitost√≠", icon: "üè†", type: "all" },
          { id: "jednotky", menuTitle: "Jednotky / byty", tileTitle: "Jednotky / byty", icon: "üè†", type: "jednotky" },
          { id: "budovy", menuTitle: "Budovy", tileTitle: "Budovy", icon: "üè¢", type: "budovy" },
          { id: "volne", menuTitle: "Voln√© jednotky", tileTitle: "Voln√© jednotky", icon: "üü¢", type: "volne" },
        ]
      }
      // ...dal≈°√≠ moduly lze podobnƒõ doplnit
    ];

    // Uk√°zkov√© z√°znamy (pro p≈ôehled/seznam)
    const pronajimatelList = [
      { id: 1, typ: "Osoba", jmeno: "Jan Nov√°k", email: "jan.novak@domena.cz", zastupce: "" },
      { id: 2, typ: "Osoba", jmeno: "Marie Nov√°kov√°", email: "marie.novakova@domena.cz", zastupce: "" },
      { id: 3, typ: "OSVƒå", jmeno: "Petr Svoboda", email: "petr.svoboda@domena.cz", zastupce: "" },
      { id: 4, typ: "OSVƒå", jmeno: "Karel Dvo≈ô√°k", email: "karel.dvorak@domena.cz", zastupce: "" },
      { id: 5, typ: "Firma", jmeno: "ABC s.r.o.", email: "info@abc.cz", zastupce: "Jan Nov√°k" },
      { id: 6, typ: "DEF a.s.", jmeno: "kontakt@def.cz", email: "kontakt@def.cz", zastupce: "Marie Nov√°kov√°" },
      { id: 7, typ: "Spolek / skupina", jmeno: "Sbor dobrovoln√Ωch hasiƒç≈Ø", email: "info@sdh.cz", zastupce: "Petr Svoboda" },
      { id: 8, typ: "Skupina sportovc≈Ø", jmeno: "sport@spolek.cz", email: "sport@spolek.cz", zastupce: "Karel Dvo≈ô√°k" },
      { id: 9, typ: "St√°tn√≠ instituce", jmeno: "√ö≈ôad pr√°ce", email: "urad@stat.cz", zastupce: "" },
      { id: 10, typ: "Mƒõstsk√Ω √∫≈ôad", jmeno: "mesto@stat.cz", email: "mesto@stat.cz", zastupce: "" },
      { id: 11, typ: "Z√°stupce", jmeno: "Mgr. Zdenƒõk Z√°stupn√Ω", email: "zastupce@firma.cz", zastupce: "" },
      { id: 12, typ: "Bc. Eva Z√°stupn√°", jmeno: "eva.zastupna@sdh.cz", email: "eva.zastupna@sdh.cz", zastupce: "" }
    ];

    // MENU RENDER
    function renderNav() {
      const nav = document.getElementById('nav');
      nav.innerHTML = '';
      modules.forEach(mod => {
        const s = document.createElement('div');
        s.className = 'section open';
        const head = document.createElement('div');
        head.className = 'section-header';
        head.innerHTML = `<span class="chev">‚ñ∂</span> <strong>${mod.title}</strong>`;
        head.onclick = () => {
          renderMainTiles(mod.id);
          renderCrumbs(mod.title);
        };
        s.appendChild(head);
        const box = document.createElement('div');
        box.className = 'section-items';
        mod.items.forEach(it => {
          const item = document.createElement('div');
          item.className = 'nav-item';
          item.innerHTML = `<span class="icon">${it.icon}</span> <span>${it.menuTitle}</span>`;
          item.onclick = () => {
            handleMenuClick(mod.id, it.type);
          };
          box.appendChild(item);
        });
        s.appendChild(box);
        nav.appendChild(s);
      });
    }

    // DLA≈ΩDICE RENDER
    function renderMainTiles(modId) {
      const main = document.getElementById('main');
      main.innerHTML = '';
      const mod = modules.find(m => m.id === modId);
      if (!mod) return;
      const grid = document.createElement('div');
      grid.className = 'grid';
      mod.items.forEach(it => {
        const card = document.createElement('div');
        card.className = 'tile';
        card.innerHTML = `
          <div class="icon">${it.icon}</div>
          <div class="title"><span>${it.icon}</span> ${it.tileTitle}</div>
          <div class="desc">#${it.type}</div>
        `;
        card.onclick = () => {
          handleMenuClick(mod.id, it.type);
        };
        grid.appendChild(card);
      });
      main.appendChild(grid);
    }

    // HANDLER (menu i dla≈ædice)
    function handleMenuClick(modId, type) {
      renderCrumbs(modules.find(m => m.id === modId).title, type);
      if (modId === "pronajimatel") {
        renderPronajimatelSeznam(type);
      }
      // Ostatn√≠ moduly: lze roz≈°√≠≈ôit zde
      else {
        document.getElementById('main').innerHTML = `<div style="padding:24px">Zde bude seznam pro <strong>${modId}</strong> [typ: <strong>${type}</strong>]</div>`;
      }
    }

    // SEZNAM PRONAJIMATEL≈Æ
    function renderPronajimatelSeznam(type) {
      let filtered = pronajimatelList;
      if (type && type !== 'all') {
        filtered = pronajimatelList.filter(r => {
          if(type === "spolek") return r.typ === "Spolek / skupina";
          if(type === "zastupce") return r.typ === "Z√°stupce";
          if(type === "stat") return r.typ === "St√°tn√≠ instituce";
          return r.typ.toLowerCase() === type.toLowerCase();
        });
      }
      const main = document.getElementById('main');
      main.innerHTML = `
        <div style="padding:24px 24px 10px 24px; display:flex; justify-content:space-between; align-items:center">
          <h2>Seznam pronaj√≠matel≈Ø</h2>
          <button class="btn primary" id="addNew">+ P≈ôidat nov√Ω pronaj√≠matele</button>
        </div>
        <div style="padding:0 24px">
          <table class="list-table">
            <thead>
              <tr>
                <th>Typ</th><th>Jm√©no</th><th>Email</th><th>Z√°stupce</th><th>Akce</th>
              </tr>
            </thead>
            <tbody>
              ${filtered.map(r => `
                <tr>
                  <td><span style="font-size:17px">${typeIcons[getTypeId(r.typ)] || ""}</span> ${r.typ}</td>
                  <td>${r.jmeno}</td>
                  <td>${r.email}</td>
                  <td>${r.zastupce || ''}</td>
                  <td class="list-actions">
                    <button class="btn" onclick='openFormModal("${getTypeId(r.typ)}")'>Upravit</button>
                  </td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      `;
      document.getElementById('addNew').onclick = () => {
        openFormModal("osoba");
      };
    }

    // CRUMBS RENDER
    function renderCrumbs(modulTitle, type) {
      const crumbs = document.getElementById('crumbs');
      crumbs.innerHTML = '';
      crumbs.appendChild(makeCrumb('Hlavn√≠ panel'));
      if (modulTitle) crumbs.appendChild(makeCrumb(modulTitle));
      if (type && type !== 'all') crumbs.appendChild(makeCrumb(type));
    }
    function makeCrumb(text) {
      const sp = document.createElement('span');
      sp.className = 'crumb';
      sp.textContent = text;
      return sp;
    }

    // UTILS
    function getTypeId(title) {
      let lower = title.toLowerCase();
      if(lower.includes('osoba')) return 'osoba';
      if(lower.includes('osvc')) return 'osvc';
      if(lower.includes('firma')) return 'firma';
      if(lower.includes('spolek')) return 'spolek';
      if(lower.includes('st√°tn√≠')) return 'stat';
      if(lower.includes('z√°stupce')) return 'zastupce';
      return null;
    }

    document.getElementById('backHome').onclick = () => { renderMainTiles(modules[0].id); renderCrumbs(); };
    document.getElementById('resetFilter').onclick = () => { renderMainTiles(modules[0].id); renderCrumbs(); };
    document.getElementById('addTile').onclick = () => openFormModal('osoba');
    document.getElementById('openMenu').onclick = () => document.getElementById('sidebar').classList.add('open');
    document.addEventListener('click', (e) => {
      if (window.innerWidth <= 900) {
        const aside = document.getElementById('sidebar');
        if (aside && !aside.contains(e.target) && !e.target.closest('#openMenu')) {
          aside.classList.remove('open');
        }
      }
    });

    // MODAL OKNO PRO FORMUL√Å≈ò
    function openFormModal(type) {
      fetch('src/forms/form-pronajimatel-najemnik.html')
        .then(res => res.text())
        .then(html => {
          document.getElementById('modalArea').innerHTML = html;
          document.getElementById('formModal').classList.add('active');
          setupForm({ module: 'pronajimatel', type });
        });
    }
    function closeFormModal() {
      document.getElementById('formModal').classList.remove('active');
      document.getElementById('modalArea').innerHTML = '';
    }
    document.getElementById('modalClose').onclick = closeFormModal;
    document.getElementById('formModal').addEventListener('click', function(e) {
      if (e.target === this) closeFormModal();
    });

    // Funkce pro nastaven√≠ formul√°≈ôe po naƒçten√≠
    function setupForm({ module = 'pronajimatel', type = 'firma' }) {
      const titleMap = {
        pronajimatel: 'Nov√Ω pronaj√≠matel',
        najemnik: 'Nov√Ω n√°jemn√≠k',
      };
      const typeLabels = {
        firma: 'Firma',
        'statni-instituce': 'St√°tn√≠ instituce',
        osoba: 'Osoba',
        osvc: 'OSVƒå',
        spolek: 'Spolek/skupina',
        stat: 'St√°tn√≠ instituce',
        zastupce: 'Z√°stupce',
      };
      document.getElementById('formTitle').textContent =
        `${titleMap[module] || 'Nov√Ω z√°znam'} ‚Äì ${typeLabels[type] || type}`;
      // Zobraz relevantn√≠ pole
      document.querySelectorAll('.form-row').forEach(row => {
        const allowed = (row.dataset.types || '').split(' ');
        row.style.display = allowed.includes(type) ? '' : 'none';
      });
      // Zru≈°itko
      const cancel = document.getElementById('formCancel');
      if (cancel) {
        cancel.onclick = () => {
          document.getElementById('mainForm').reset();
          closeFormModal();
        };
      }
      // Submit
      document.getElementById('mainForm').onsubmit = function(e) {
        e.preventDefault();
        alert('Formul√°≈ô byl √∫spƒõ≈°nƒõ odesl√°n!');
        closeFormModal();
      };
    }

    // INIT
    renderNav();
    renderMainTiles(modules[0].id);
    renderCrumbs(modules[0].title);
  </script>
</body>
</html>
