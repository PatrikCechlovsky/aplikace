<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Aplikace pronaj√≠matel ‚Äì Hlavn√≠ panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg: #0b0f14;
      --card: #121821;
      --muted: #99a3b3;
      --text: #e6edf3;
      --brand: #4cc9f0; /* Hlavn√≠ barva, lze mƒõnit v nastaven√≠ */
      --accent: #80ffdb;
      --border: #1c2430;
      --active: #21344a;
      --danger: #ff647f;
      --ok: #9bffb0;
      --form-field-bg: #192029;
      --form-field-border: #27445f;
    }
    * { box-sizing: border-box }
    html, body { height: 100% }
    body {
      margin: 0; background: radial-gradient(1200px 800px at 70% -10%, rgba(128,255,219,0.09), transparent 50%),
                               radial-gradient(900px 600px at -10% 30%, rgba(76,201,240,0.08), transparent 50%), var(--bg);
      color: var(--text); font: 15px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial;
    }
    .app { display: grid; grid-template-columns: 280px 1fr; height: 100vh; }
    aside {
      background: linear-gradient(180deg, rgba(33,52,74,.4), rgba(18,24,33,.7) 30%), var(--card);
      border-right: 1px solid var(--border);
      padding: 16px 12px; overflow-y: auto;
    }
    .brand { display:flex; align-items:center; gap:10px; padding: 8px 10px; margin-bottom: 10px }
    .brand i { font-style: normal; font-size: 20px }
    .brand strong { letter-spacing:.3px }
    .section { margin: 14px 6px; border-radius:12px; overflow:hidden; border:1px solid var(--border); background: #0e141c }
    .section-header { display:flex; align-items:center; gap:8px; padding:10px 12px; cursor:pointer; user-select:none; }
    .section-header:hover { background: #111924 }
    .section-header .chev { transition: transform .2s ease }
    .section.open .section-header .chev { transform: rotate(90deg) }
    .section-items { display:none; padding:8px 4px 10px }
    .section.open .section-items { display:block }
    .nav-item { display:flex; align-items:center; gap:8px; padding:8px 10px; margin:4px 6px; border-radius:10px; cursor:pointer; color:var(--muted) }
    .nav-item:hover { background:#101826; color:var(--text) }
    .nav-item.active { background: var(--active); color: var(--text); border: 1px solid #243449 }
    .mini { font-size:12px; color:var(--muted); padding: 4px 14px 0 }
    header {
      display:flex; align-items:center; justify-content:space-between; padding: 14px 18px; position: sticky; top:0; background: linear-gradient(180deg, rgba(11,15,20,.96), rgba(11,15,20,.8)); backdrop-filter: blur(4px); border-bottom: 1px solid var(--border);
      z-index: 5;
    }
    .breadcrumbs { display:flex; gap:8px; align-items:center; color: var(--muted) }
    .breadcrumbs .crumb { padding:6px 10px; border-radius:999px; border:1px solid var(--border); background:#0e141c }
    .actions { display:flex; gap:8px; align-items:center }
    .btn {
      padding:9px 12px; border-radius:10px; border:1px solid var(--border); background: #101826; color:var(--text); cursor:pointer;
      transition: background .2s, border .2s;
    }
    .btn.primary { background: linear-gradient(180deg, var(--brand), #183249 70%, #112336); border-color:var(--brand) }
    .btn.ghost { background: transparent }
    .btn:disabled { opacity:.5; cursor:not-allowed }
    main { height: 100vh; overflow: auto; }
    .grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 14px; padding: 16px 18px 120px }
    .tile { position:relative; border:1px solid var(--border); border-radius:16px; padding:14px; background: linear-gradient(180deg, rgba(33,52,74,.28), rgba(16,24,38,.8)), var(--card); cursor:pointer; min-height:120px; display:flex; flex-direction:column; gap:10px; transition:box-shadow 0.15s }
    .tile:hover { outline:2px solid var(--brand); box-shadow:0 4px 24px 0 rgba(76,201,240,.09) }
    .tile .icon { font-size:32px }
    .tile .title { font-weight:600 }
    .pill { font-size:11px; padding:4px 8px; border-radius:999px; border:1px solid var(--border); color: var(--muted); background:#101826; margin-left:2px; }
    .list-table { width:100%; border-spacing:0; margin-bottom:30px }
    .list-table th, .list-table td { padding:7px 10px; border-bottom:1px solid var(--border); text-align:left }
    .list-table tr:hover { background:#101826 }
    .list-table th { color:var(--muted); background:#121821 }
    .list-actions { display:flex; gap:10px }
    .form-modal {
      position: fixed; left: 0; top: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,.55); z-index: 1000; display: flex; align-items: center; justify-content: center;
    }
    .form-modal-content {
      background: var(--card); border-radius: 14px; box-shadow: 0 4px 32px 0 rgba(76,201,240,.19); padding: 40px 32px 24px 32px; min-width:320px; max-width: 440px;
      border:2px solid var(--brand);
      position: relative;
    }
    .form-modal-close {
      position: absolute; top: 18px; right: 18px; font-size:22px; color:var(--muted); background: none; border: none; cursor: pointer;
    }
    .form-label { display: block; margin: 0 0 9px 0; color: var(--text); font-weight:500 }
    .form-field {
      width: 100%; padding: 10px; border-radius: 8px; background: var(--form-field-bg); border: 1.5px solid var(--form-field-border); color: var(--text); font-size:16px; margin-bottom:14px;
      transition: border .2s;
    }
    .form-field:focus { border-color: var(--brand); outline: none; }
    .form-modal-content h3 { margin-bottom: 18px; color: var(--brand); }
    .color-picker-label { display: flex; align-items: center; gap:10px; margin: 14px 0 4px 0; font-size:15px }
    @media (max-width: 900px) {
      .app { grid-template-columns: 1fr }
      aside { position: fixed; z-index: 30; width: 88%; max-width: 320px; inset: 0 auto 0 0; transform: translateX(-102%); transition: transform .25s ease }
      aside.open { transform: translateX(0) }
      header .menu { display:inline-flex }
    }
    @media (min-width: 901px) { header .menu { display:none } }
  </style>
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside id="sidebar">
      <div class="brand"><i>üè†</i><strong>Aplikace pronaj√≠matel</strong></div>
      <div id="nav"></div>
      <div class="mini">Klik na sekci = otev≈ôe panel sekce. Klik na polo≈æku = otev≈ôe rovnou seznam.</div>
    </aside>
    <div style="display:flex; flex-direction:column">
      <!-- Header -->
      <header>
        <div class="left" style="display:flex; align-items:center; gap:10px">
          <button class="btn ghost menu" id="openMenu">‚ò∞</button>
          <div class="breadcrumbs" id="crumbs">
            <span class="crumb">Hlavn√≠ panel</span>
          </div>
        </div>
        <div class="actions">
          <button class="btn" id="backHome" style="display:none">‚Üê Zpƒõt</button>
          <button class="btn" id="resetFilter">Zru≈°it filtr</button>
          <button class="btn primary" id="addTile">+ P≈ôidat dla≈ædici</button>
        </div>
      </header>
      <!-- Main content -->
      <main id="main"></main>
    </div>
  </div>
  <div id="formModalArea"></div>
  <script>
    // Typy pronaj√≠matel≈Ø a n√°jemn√≠k≈Ø ‚Äì doplnƒõno Spolek/skupina a Z√°stupce
    const pronajimatelTypes = [
      { id: 'osoba', title: 'Osoba', form: 'form-osoba.html' },
      { id: 'osvc', title: 'OSVƒå', form: 'form-osvc.html' },
      { id: 'firma', title: 'Firma', form: 'form-firma.html' },
      { id: 'spolek', title: 'Spolek / skupina', form: 'form-spolek.html' },
      { id: 'stat', title: 'St√°tn√≠ instituce', form: null }, // zat√≠m neexistuje
      { id: 'zastupce', title: 'Z√°stupce', form: 'form-zastupce.html' }
    ];
    const najemnikTypes = [
      { id: 'osoba', title: 'Osoba', form: 'form-osoba.html' },
      { id: 'osvc', title: 'OSVƒå', form: 'form-osvc.html' },
      { id: 'firma', title: 'Firma', form: 'form-firma.html' },
      { id: 'spolek', title: 'Spolek / skupina', form: 'form-spolek.html' },
      { id: 'stat', title: 'St√°tn√≠ instituce', form: null }, // zat√≠m neexistuje
      { id: 'zastupce', title: 'Z√°stupce', form: 'form-zastupce.html' }
    ];

    // Uk√°zkov√© z√°znamy (ka≈æd√Ω typ pro uk√°zku 2 z√°znamy)
    const pronajimatelList = [
      { id: 1, typ: 'Osoba', jmeno: 'Jan Nov√°k', email: 'jan.novak@domena.cz', zastupce: '' },
      { id: 2, typ: 'Osoba', jmeno: 'Marie Nov√°kov√°', email: 'marie.novakova@domena.cz', zastupce: '' },
      { id: 3, typ: 'OSVƒå', jmeno: 'Petr Svoboda', email: 'petr.svoboda@domena.cz', zastupce: '' },
      { id: 4, typ: 'OSVƒå', jmeno: 'Karel Dvo≈ô√°k', email: 'karel.dvorak@domena.cz', zastupce: '' },
      { id: 5, typ: 'Firma', jmeno: 'ABC s.r.o.', email: 'info@abc.cz', zastupce: 'Jan Nov√°k' },
      { id: 6, typ: 'Firma', jmeno: 'DEF a.s.', email: 'kontakt@def.cz', zastupce: 'Marie Nov√°kov√°' },
      { id: 7, typ: 'Spolek / skupina', jmeno: 'Sbor dobrovoln√Ωch hasiƒç≈Ø', email: 'info@sdh.cz', zastupce: 'Petr Svoboda' },
      { id: 8, typ: 'Spolek / skupina', jmeno: 'Skupina sportovc≈Ø', email: 'sport@spolek.cz', zastupce: 'Karel Dvo≈ô√°k' },
      { id: 9, typ: 'St√°tn√≠ instituce', jmeno: '√ö≈ôad pr√°ce', email: 'urad@stat.cz', zastupce: '' },
      { id: 10, typ: 'St√°tn√≠ instituce', jmeno: 'Mƒõstsk√Ω √∫≈ôad', email: 'mesto@stat.cz', zastupce: '' },
      { id: 11, typ: 'Z√°stupce', jmeno: 'Mgr. Zdenƒõk Z√°stupn√Ω', email: 'zastupce@firma.cz', zastupce: '' },
      { id: 12, typ: 'Z√°stupce', jmeno: 'Bc. Eva Z√°stupn√°', email: 'eva.zastupna@sdh.cz', zastupce: '' }
    ];
    const najemnikList = [
      { id: 1, typ: 'Osoba', jmeno: 'Jana Mal√°', email: 'jana.mala@domena.cz', zastupce: '' },
      { id: 2, typ: 'Osoba', jmeno: 'Tom√°≈° Velk√Ω', email: 'tomas.velky@domena.cz', zastupce: '' },
      { id: 3, typ: 'OSVƒå', jmeno: 'Eva Mal√°', email: 'eva.mala@domena.cz', zastupce: '' },
      { id: 4, typ: 'OSVƒå', jmeno: 'Adam Velk√Ω', email: 'adam.velky@domena.cz', zastupce: '' },
      { id: 5, typ: 'Firma', jmeno: 'GHI s.r.o.', email: 'info@ghi.cz', zastupce: 'Jana Mal√°' },
      { id: 6, typ: 'Firma', jmeno: 'JKL a.s.', email: 'kontakt@jkl.cz', zastupce: 'Tom√°≈° Velk√Ω' },
      { id: 7, typ: 'Spolek / skupina', jmeno: 'Muzikanti', email: 'muzikanti@spolek.cz', zastupce: 'Eva Mal√°' },
      { id: 8, typ: 'Spolek / skupina', jmeno: 'Turist√©', email: 'turiste@spolek.cz', zastupce: 'Adam Velk√Ω' },
      { id: 9, typ: 'St√°tn√≠ instituce', jmeno: 'Finanƒçn√≠ √∫≈ôad', email: 'fin@stat.cz', zastupce: '' },
      { id: 10, typ: 'St√°tn√≠ instituce', jmeno: 'Krajsk√Ω √∫≈ôad', email: 'kraj@stat.cz', zastupce: '' },
      { id: 11, typ: 'Z√°stupce', jmeno: 'JUDr. Martin Z√°stupn√Ω', email: 'martin.zastupny@firma.cz', zastupce: '' },
      { id: 12, typ: 'Z√°stupce', jmeno: 'Ing. Petra Z√°stupn√°', email: 'petra.zastupna@sdh.cz', zastupce: '' }
    ];

    // Sekce v menu
    const sections = [
      { id: 'pronajimatel', title: 'Pronaj√≠matel', open: true, items: [
        { id: 'seznam-pronajimatelu', title: 'Seznam v≈°ech pronaj√≠matel≈Ø', type: 'all', icon: 'üßë‚Äçüíº' },
        ...pronajimatelTypes.map(t => ({ id: `typ-${t.id}-pronajimatel`, title: t.title, type: t.id, icon: 'üî∏' }))
      ]},
      { id: 'nemovitosti', title: 'Nemovitosti', open: true, items: [
        { id: 'prehled-nemovitosti', title: 'P≈ôehled', tag: 'nemovitosti' },
        { id: 'jednotky', title: 'Jednotky / byty', tag: 'byty' },
        { id: 'budovy', title: 'Budovy', tag: 'budovy' },
        { id: 'volne', title: 'Voln√© jednotky', tag: 'volne' },
      ]},
      { id: 'najemnici', title: 'N√°jemn√≠ci', open: true, items: [
        { id: 'seznam-najemniku', title: 'Seznam v≈°ech n√°jemn√≠k≈Ø', type: 'all', icon: 'üë§' },
        ...najemnikTypes.map(t => ({ id: `typ-${t.id}-najemnik`, title: t.title, type: t.id, icon: 'üî∏' }))
      ]},
      { id: 'finance', title: 'Finance', open: false, items: [
        { id: 'prijmy', title: 'N√°jemn√© a z√°lohy', tag: 'finance' },
        { id: 'naklady', title: 'N√°klady a slu≈æby', tag: 'naklady' },
        { id: 'dluznici', title: 'Dlu≈æn√≠ci', tag: 'dluhy' },
        { id: 'vyuctovani', title: 'Vy√∫ƒçtov√°n√≠ slu≈æeb', tag: 'vyuctovani' },
      ]},
      { id: 'energie', title: 'Energie', open: false, items: [
        { id: 'meridla', title: 'Mƒõ≈ôidla a odeƒçty', tag: 'energie' },
        { id: 'spotreby', title: 'Spot≈ôeby a grafy', tag: 'spotreby' },
      ]},
      { id: 'udrzba', title: '√ödr≈æba', open: false, items: [
        { id: 'ukoly', title: '√ökoly a servis', tag: 'udrzba' },
        { id: 'revize', title: 'Revize a prohl√≠dky', tag: 'revize' },
        { id: 'plan-revizi', title: 'Pl√°n reviz√≠', tag: 'plan-revizi' },
      ]},
      { id: 'dokumenty', title: 'Dokumenty', open: false, items: [
        { id: 'slozky', title: 'Slo≈æky a ≈°ablony', tag: 'dokumenty' },
      ]},
      { id: 'reporty', title: 'Reporty', open: false, items: [
        { id: 'exporty', title: 'Exporty a sestavy', tag: 'reporty' },
      ]},
      { id: 'komunikace', title: 'Komunikace', open: false, items: [
        { id: 'zpravy', title: 'E‚Äëmaily a SMS', tag: 'komunikace' },
        { id: 'pozadavky', title: 'Po≈æadavky od n√°jemn√≠k≈Ø', tag: 'pozadavky' },
      ]},
      { id: 'nastaveni', title: 'Nastaven√≠', open: false, items: [
        { id: 'profil', title: 'Profil a u≈æivatel√©', tag: 'nastaveni' },
        { id: 'integrace', title: 'Integrace (ARES apod.)', tag: 'integrace' },
        { id: 'barva', title: 'Barvy aplikace', tag: 'barva' }
      ]}
    ];

    // State
    let view = { mode: 'home', sectionId: null, listId: null, filterType: null, editing: null };

    function renderNav() {
      const nav = document.getElementById('nav');
      nav.innerHTML = '';
      sections.forEach(sec => {
        const s = document.createElement('div');
        s.className = 'section' + (sec.open ? ' open' : '');
        const head = document.createElement('div');
        head.className = 'section-header';
        head.innerHTML = `<span class="chev">‚ñ∂</span> <strong>${sec.title}</strong>`;
        head.onclick = () => {
          sec.open = !sec.open;
          renderNav();
          setView('section', sec.id);
        };
        s.appendChild(head);
        const box = document.createElement('div');
        box.className = 'section-items';
        sec.items.forEach(it => {
          const item = document.createElement('div');
          item.className = 'nav-item';
          item.innerHTML = `<span>${it.icon || "‚Ä¢"}</span> <span>${it.title}</span>`;
          item.onclick = () => {
            setView('list', it.id, it.type);
          };
          box.appendChild(item);
        });
        s.appendChild(box);
        nav.appendChild(s);
      });
    }

    function renderMain() {
      const main = document.getElementById('main');
      main.innerHTML = '';
      if (view.mode === 'home') {
        main.innerHTML = `
          <div style="padding:32px">
            <h2>V√≠tejte v aplikaci pronaj√≠matel</h2>
            <p>Zvolte modul v lev√©m menu.</p>
          </div>
        `;
      } else if (view.mode === 'list') {
        if (view.sectionId === 'pronajimatel') {
          renderSeznam(main, 'Pronaj√≠matel', pronajimatelList, view.filterType);
        }
        else if (view.sectionId === 'najemnici') {
          renderSeznam(main, 'N√°jemn√≠k', najemnikList, view.filterType);
        } else if (view.sectionId === 'nastaveni' && view.filterType === 'barva') {
          renderColorSettings(main);
        }
        else {
          main.innerHTML = `<h2 style="padding:24px">Zde bude seznam nebo detail polo≈æky <span style="color:var(--accent)">"${view.listId}"</span> (propojen√≠ na formul√°≈ô).</h2>`;
        }
      } else if (view.mode === 'section') {
        const sec = sections.find(s => s.id === view.sectionId);
        if (!sec) return;
        const grid = document.createElement('div');
        grid.className = 'grid';
        sec.items.forEach(it => {
          const card = document.createElement('div');
          card.className = 'tile';
          card.innerHTML = `
            <div class="icon">üìÅ</div>
            <div class="title">${it.title}</div>
            <div style="color:var(--muted)">${it.type ? "#"+it.type : (it.tag ? "#"+it.tag : "")}</div>
          `;
          grid.appendChild(card);
        });
        main.appendChild(grid);
      }
    }

    function renderSeznam(main, typ, data, filterType) {
      let filtered = data;
      if (filterType && filterType !== 'all') {
        filtered = data.filter(r => {
          if(filterType === "spolek") return r.typ === "Spolek / skupina";
          if(filterType === "zastupce") return r.typ === "Z√°stupce";
          if(filterType === "stat") return r.typ === "St√°tn√≠ instituce";
          return r.typ.toLowerCase() === filterType.toLowerCase();
        });
      }
      main.innerHTML = `
        <div style="padding:24px 24px 10px 24px; display:flex; justify-content:space-between; align-items:center">
          <h2>Seznam v≈°ech ${typ.toLowerCase()}≈Ø</h2>
          <button class="btn primary" id="addNew">+ P≈ôidat nov√Ω ${typ.toLowerCase()}</button>
        </div>
        <div style="padding:0 24px">
          <table class="list-table">
            <thead>
              <tr><th>Typ</th><th>Jm√©no</th><th>Email</th><th>Z√°stupce</th><th>Akce</th></tr>
            </thead>
            <tbody>
              ${filtered.map(r => `
                <tr>
                  <td>${r.typ}</td>
                  <td>${r.jmeno}</td>
                  <td>${r.email}</td>
                  <td>${r.zastupce || ''}</td>
                  <td class="list-actions">
                    <button class="btn" onclick="showForm('${typ}',${r.id})">Upravit</button>
                  </td>
                </tr>
              `).join('')}
            </tbody>
          </table>
        </div>
      `;
      document.getElementById('addNew').onclick = () => {
        showForm(typ, null, filterType);
      };
      window.showForm = (typ, id, filterType) => {
        showForm(typ, id, filterType);
      };
    }

    // MOD√ÅLN√ç FORMUL√Å≈ò
    function showForm(typ, id, filterType) {
      // Zjisti z√°znam
      let record = null, types = null, data = null;
      if(typ === 'Pronaj√≠matel') { types = pronajimatelTypes; data = pronajimatelList; }
      else if(typ === 'N√°jemn√≠k') { types = najemnikTypes; data = najemnikList; }
      if(id) record = data.find(x => x.id === id);
      let typeId = filterType || (record ? getTypeId(record.typ) : null);
      let typeObj = typeId ? types.find(t => t.title === record?.typ || t.id === typeId) : null;
      let formFile = typeObj?.form || null;
      // St√°tn√≠ instituce ‚Äì nem√° form
      if(typeId === "stat" || (record && record.typ === "St√°tn√≠ instituce")) {
        return showModal(`<h3>Formul√°≈ô nen√≠ p≈ôipraven</h3><div style="margin-bottom:18px">Pro ‚ÄûSt√°tn√≠ instituci‚Äú zat√≠m nen√≠ formul√°≈ô dostupn√Ω.</div><button class="btn" onclick="closeModal()">Zav≈ô√≠t</button>`);
      }
      // Naƒçti HTML formul√°≈ô z /src/forms/
      if(formFile) {
        fetch(`src/forms/${formFile}`)
          .then(res => res.text())
          .then(html => {
            // Vlo≈æ do modal s grafickou √∫pravou
            showModal(`
              <h3>${id ? 'Upravit' : 'P≈ôidat'} ${typ.toLowerCase()}</h3>
              <form id="mainForm">${html}</form>
              <button class="btn primary" type="submit" form="mainForm">${id ? 'Ulo≈æit zmƒõny' : 'P≈ôidat z√°znam'}</button>
              <button class="btn" type="button" onclick="closeModal()">Zru≈°it</button>
            `);
            stylizeFormFields();
            document.getElementById('mainForm').onsubmit = (e) => {
              e.preventDefault();
              alert('Z√°znam ulo≈æen (uk√°zka)');
              closeModal();
            };
          });
      } else {
        // fallback jednoduch√Ω form
        showModal(`
          <h3>${id ? 'Upravit' : 'P≈ôidat'} ${typ.toLowercase()}</h3>
          <form id="mainForm">
            <label class="form-label">Typ: <input class="form-field" name="typ" value="${record?.typ || ''}" required></label>
            <label class="form-label">Jm√©no: <input class="form-field" name="jmeno" value="${record?.jmeno || ''}" required></label>
            <label class="form-label">Email: <input class="form-field" name="email" value="${record?.email || ''}" required></label>
            <label class="form-label">Z√°stupce: <input class="form-field" name="zastupce" value="${record?.zastupce || ''}"></label>
            <button class="btn primary" type="submit">${id ? 'Ulo≈æit zmƒõny' : 'P≈ôidat z√°znam'}</button>
            <button class="btn" type="button" onclick="closeModal()">Zru≈°it</button>
          </form>
        `);
        stylizeFormFields();
        document.getElementById('mainForm').onsubmit = (e) => {
          e.preventDefault();
          alert('Z√°znam ulo≈æen (uk√°zka)');
          closeModal();
        };
      }
    }

    function getTypeId(title) {
      let lower = title.toLowerCase();
      if(lower.includes('osoba')) return 'osoba';
      if(lower.includes('osvc')) return 'osvc';
      if(lower.includes('firma')) return 'firma';
      if(lower.includes('spolek')) return 'spolek';
      if(lower.includes('st√°tn√≠')) return 'stat';
      if(lower.includes('z√°stupce')) return 'zastupce';
      return null;
    }

    function stylizeFormFields() {
      // v≈°echny input/select/textarea pole ve form dostanou t≈ô√≠du .form-field
      setTimeout(() => {
        document.querySelectorAll('#mainForm input, #mainForm select, #mainForm textarea').forEach(el => {
          el.classList.add('form-field');
        });
        document.querySelectorAll('#mainForm label').forEach(el => {
          el.classList.add('form-label');
        });
      }, 0);
    }

    function showModal(html) {
      const area = document.getElementById('formModalArea');
      area.innerHTML = `
        <div class="form-modal">
          <div class="form-modal-content">
            <button class="form-modal-close" onclick="closeModal()">√ó</button>
            ${html}
          </div>
        </div>
      `;
      window.closeModal = () => { area.innerHTML = ''; };
    }

    function renderColorSettings(main) {
      main.innerHTML = `
        <div style="padding:32px">
          <h2>Nastaven√≠ barev aplikace</h2>
          <label class="color-picker-label">Hlavn√≠ barva: <input type="color" id="brandColorPicker" value="${getComputedStyle(document.documentElement).getPropertyValue('--brand').trim()}"></label>
          <div style="margin:16px 0 6px 0; color:var(--muted)">Zmƒõna barvy se projev√≠ ihned v cel√© aplikaci.</div>
        </div>
      `;
      setTimeout(() => {
        document.getElementById('brandColorPicker').oninput = (e) => {
          document.documentElement.style.setProperty('--brand', e.target.value);
          renderMain();
        };
      }, 0);
    }

    function renderCrumbs() {
      const crumbs = document.getElementById('crumbs');
      crumbs.innerHTML = '';
      crumbs.appendChild(makeCrumb('Hlavn√≠ panel'));
      if (view.sectionId) {
        const sec = sections.find(s => s.id === view.sectionId);
        if (sec) crumbs.appendChild(makeCrumb(sec.title));
      }
      if (view.filterType && view.filterType !== 'all') {
        crumbs.appendChild(makeCrumb(view.filterType));
      }
      if (view.editing) {
        crumbs.appendChild(makeCrumb('√öprava'));
      }
      document.getElementById('backHome').style.display = (view.mode === 'home') ? 'none' : 'inline-flex';
    }
    function makeCrumb(text) {
      const sp = document.createElement('span');
      sp.className = 'crumb';
      sp.textContent = text;
      return sp;
    }

    function setView(mode, payload, filterType) {
      view.mode = mode;
      if (mode === 'section') view.sectionId = payload;
      else if (mode === 'list') {
        if (payload.startsWith('seznam-pronajimatelu')) {
          view.sectionId = 'pronajimatel';
          view.filterType = 'all';
        } else if (payload.startsWith('seznam-najemniku')) {
          view.sectionId = 'najemnici';
          view.filterType = 'all';
        } else if (payload.startsWith('typ-')) {
          if (payload.endsWith('-pronajimatel')) {
            view.sectionId = 'pronajimatel';
            view.filterType = filterType;
          } else if (payload.endsWith('-najemnik')) {
            view.sectionId = 'najemnici';
            view.filterType = filterType;
          }
        } else if (payload === 'barva') {
          view.sectionId = 'nastaveni';
          view.filterType = 'barva';
        } else {
          view.sectionId = payload;
        }
        view.editing = null;
      } else {
        view.sectionId = null; view.listId = null; view.filterType = null; view.editing = null;
      }
      renderMain();
      renderCrumbs();
    }

    document.getElementById('backHome').onclick = () => setView('home');
    document.getElementById('resetFilter').onclick = () => setView('home');
    document.getElementById('addTile').onclick = () => alert('P≈ôid√°n√≠ dla≈ædice ‚Äì funkce bude doplnƒõna.');
    document.getElementById('openMenu').onclick = () => document.getElementById('sidebar').classList.add('open');
    document.addEventListener('click', (e) => {
      if (window.innerWidth <= 900) {
        const aside = document.getElementById('sidebar');
        if (aside && !aside.contains(e.target) && !e.target.closest('#openMenu')) {
          aside.classList.remove('open');
        }
      }
    });

    renderNav();
    setView('home');
  </script>
</body>
</html>
