<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Pronaj√≠matel ‚Äì aplikace</title>
  <style>
    /* ... pou≈æij tv≈Øj styl z hlavni.html ... */
    /* zkr√°ceno z d≈Øvodu d√©lky */
  </style>
</head>
<body>
  <div class="app" id="app">
    <aside id="sidebar">
      <div class="brand"><i>üè†</i><strong>Pronaj√≠matel aplikace</strong></div>
      <nav id="nav"></nav>
      <div class="mini">Klik na typ pronaj√≠matele pro zobrazen√≠ seznamu a p≈ôid√°n√≠ nov√©ho.</div>
    </aside>
    <div style="display:flex; flex-direction:column">
      <header>
        <div class="breadcrumbs" id="crumbs">
          <span class="crumb">Hlavn√≠ panel</span>
          <span class="crumb" id="crumbModule"></span>
          <span class="crumb" id="crumbType"></span>
        </div>
      </header>
      <main id="main"></main>
    </div>
  </div>
  <!-- Mod√°ln√≠ okno pro formul√°≈ô -->
  <div class="overlay" id="overlay"></div>
  <div class="drawer" id="drawer">
    <header>
      <div style="display:flex; align-items:center; justify-content:space-between; padding:10px 14px">
        <strong id="drawerTitle">Nov√Ω pronaj√≠matel</strong>
        <button class="btn" id="closeDrawer">‚úï</button>
      </div>
    </header>
    <div class="body" id="drawerBody"></div>
  </div>
  <script>
    // Typy pronaj√≠matel≈Ø
    const types = [
      { id: "osoba", icon: "üßë", title: "Osoba" },
      { id: "osvc", icon: "üßë‚Äçüíº", title: "OSVƒå" },
      { id: "firma", icon: "üè¢", title: "Firma" },
      { id: "spolek", icon: "üë•", title: "Spolek / Skupina" }
    ];
    // Spoleƒçn√Ω seznam pronaj√≠matel≈Ø
    let pronajimatele = [
      // Vzory pro uk√°zku (ka≈æd√Ω m√° typ)
      { id: "p1", typ: "osoba", jmeno: "Jan Nov√°k", prijmeni: "Nov√°k", datum_narozeni: "12.12.1980", email: "novak@example.cz", archivovano: false },
      { id: "p2", typ: "firma", jmeno_firmy: "Firma s.r.o.", ic: "12345678", email: "firma@example.cz", archivovano: false }
    ];

    // Helpery
    function $(sel) { return document.querySelector(sel); }
    function el(tag, attrs={}, children=[]) {
      const n = document.createElement(tag);
      Object.entries(attrs).forEach(([k,v]) => {
        if (k === 'class') n.className = v;
        else if (k.startsWith('on')) n.addEventListener(k.substring(2), v);
        else if (k === 'html') n.innerHTML = v;
        else n.setAttribute(k, v);
      });
      children.forEach(c => n.appendChild(typeof c === 'string' ? document.createTextNode(c) : c));
      return n;
    }

    function renderNav() {
      const nav = $('#nav');
      nav.innerHTML = '';
      types.forEach(t => {
        nav.appendChild(el('div', { class:'nav-item', onClick:() => showType(t.id) }, [
          el('span', { class:'icon' }, [t.icon]), t.title
        ]));
      });
    }

    function showType(typeId) {
      const t = types.find(x=>x.id===typeId);
      $('#crumbModule').textContent = "Pronaj√≠matel";
      $('#crumbType').textContent = t.title;
      renderList(typeId);
    }

    function renderList(typeId) {
      const main = $('#main');
      main.innerHTML = '';
      const t = types.find(x=>x.id===typeId);
      const filter = pronajimatele.filter(x=>x.typ===typeId && !x.archivovano);
      // Toolbar
      main.appendChild(el('div', { class:'toolbar' }, [
        el('strong', {}, [t.icon + ' ' + t.title]),
        el('span', { class:'spacer' }),
        el('button', { class:'btn primary', onClick:() => openForm(typeId) }, ['+ P≈ôidat ' + t.title])
      ]));
      // Tabulka
      const table = el('table');
      const thead = el('thead');
      const trh = el('tr');
      if (typeId === "osoba") {
        ["Jm√©no","P≈ô√≠jmen√≠","Datum narozen√≠","Email","Akce"].forEach(h=>trh.appendChild(el('th', {}, [h])));
      } else if (typeId === "firma") {
        ["N√°zev firmy","Iƒå","Email","Akce"].forEach(h=>trh.appendChild(el('th', {}, [h])));
      } else if (typeId === "osvc") {
        ["Jm√©no","P≈ô√≠jmen√≠","Iƒå","Email","Akce"].forEach(h=>trh.appendChild(el('th', {}, [h])));
      } else if (typeId === "spolek") {
        ["N√°zev spolku","Iƒå","Email","Akce"].forEach(h=>trh.appendChild(el('th', {}, [h])));
      }
      thead.appendChild(trh); table.appendChild(thead);
      const tbody = el('tbody');
      filter.forEach(p => {
        const tr = el('tr');
        if (typeId === "osoba") {
          tr.appendChild(el('td', {}, [p.jmeno||'']));
          tr.appendChild(el('td', {}, [p.prijmeni||'']));
          tr.appendChild(el('td', {}, [p.datum_narozeni||'']));
          tr.appendChild(el('td', {}, [p.email||'']));
        } else if (typeId === "firma") {
          tr.appendChild(el('td', {}, [p.jmeno_firmy||'']));
          tr.appendChild(el('td', {}, [p.ic||'']));
          tr.appendChild(el('td', {}, [p.email||'']));
        } else if (typeId === "osvc") {
          tr.appendChild(el('td', {}, [p.jmeno||'']));
          tr.appendChild(el('td', {}, [p.prijmeni||'']));
          tr.appendChild(el('td', {}, [p.ic||'']));
          tr.appendChild(el('td', {}, [p.email||'']));
        } else if (typeId === "spolek") {
          tr.appendChild(el('td', {}, [p.jmeno_spolku||'']));
          tr.appendChild(el('td', {}, [p.ic||'']));
          tr.appendChild(el('td', {}, [p.email||'']));
        }
        // Akce
        const tdA = el('td');
        tdA.appendChild(el('button', { class:'btn', onClick:() => openForm(typeId, p.id) }, ['Upravit']));
        tdA.appendChild(el('button', { class:'btn', style:'margin-left:6px;background:#2a1520;border-color:#3a1d2a', onClick:() => archiveRecord(p.id) }, ['Archivovat']));
        tdA.appendChild(el('button', { class:'btn', style:'margin-left:6px;background:#15202a;border-color:#1a2d3a', onClick:() => deleteRecord(p.id) }, ['Smazat']));
        tr.appendChild(tdA);
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      main.appendChild(table);
    }

    // Formul√°≈ô pro p≈ôid√°n√≠/upraven√≠
    function openForm(typeId, editId=null) {
      $('#drawerTitle').textContent = (editId ? 'Upravit' : 'Nov√Ω') + ' ' + types.find(x=>x.id===typeId).title;
      $('#overlay').classList.add('show'); $('#drawer').classList.add('open');
      const body = $('#drawerBody');
      body.innerHTML = '';
      let record = editId ? pronajimatele.find(x=>x.id===editId) : {};
      if (typeId === "osoba" || typeId === "osvc") {
        body.appendChild(el('label', {}, ['Jm√©no']));
        body.appendChild(el('input', { id:'f_jmeno', class:'input', value:record.jmeno||"" }));
        body.appendChild(el('label', {}, ['P≈ô√≠jmen√≠']));
        body.appendChild(el('input', { id:'f_prijmeni', class:'input', value:record.prijmeni||"" }));
        body.appendChild(el('label', {}, ['Datum narozen√≠']));
        body.appendChild(el('input', { id:'f_datum', class:'input', value:record.datum_narozeni||"" }));
      }
      if (typeId === "firma") {
        body.appendChild(el('label', {}, ['N√°zev firmy']));
        body.appendChild(el('input', { id:'f_jmeno_firmy', class:'input', value:record.jmeno_firmy||"" }));
      }
      if (typeId === "spolek") {
        body.appendChild(el('label', {}, ['N√°zev spolku']));
        body.appendChild(el('input', { id:'f_jmeno_spolku', class:'input', value:record.jmeno_spolku||"" }));
      }
      // Dal≈°√≠ pole univerz√°lnƒõ
      body.appendChild(el('label', {}, ['Iƒå']));
      body.appendChild(el('input', { id:'f_ic', class:'input', value:record.ic||"" }));
      body.appendChild(el('label', {}, ['Email']));
      body.appendChild(el('input', { id:'f_email', class:'input', value:record.email||"" }));
      body.appendChild(el('label', {}, ['Archivov√°no']));
      body.appendChild(el('input', { id:'f_archivovano', type:'checkbox', checked:!!record.archivovano }));
      // Tlaƒç√≠tka ulo≈æen√≠
      body.appendChild(el('button', { class:'btn primary', style:'margin-top:12px', onClick:() => saveForm(typeId, editId) }, ['Ulo≈æit']));
      body.appendChild(el('button', { class:'btn ghost', style:'margin-left:8px', onClick:closeForm }, ['Zru≈°it']));
    }
    function closeForm() {
      $('#overlay').classList.remove('show'); $('#drawer').classList.remove('open');
    }
    $('#closeDrawer').addEventListener('click', closeForm);
    $('#overlay').addEventListener('click', closeForm);

    // Ulo≈æen√≠ formul√°≈ôe
    function saveForm(typeId, editId) {
      let record = editId ? pronajimatele.find(x=>x.id===editId) : { id:'p'+Date.now(), typ:typeId };
      if (typeId === "osoba" || typeId === "osvc") {
        record.jmeno = $('#f_jmeno').value;
        record.prijmeni = $('#f_prijmeni').value;
        record.datum_narozeni = $('#f_datum').value;
      }
      if (typeId === "firma") {
        record.jmeno_firmy = $('#f_jmeno_firmy').value;
      }
      if (typeId === "spolek") {
        record.jmeno_spolku = $('#f_jmeno_spolku').value;
      }
      record.ic = $('#f_ic').value;
      record.email = $('#f_email').value;
      record.archivovano = $('#f_archivovano').checked;
      if (!editId) pronajimatele.push(record);
      closeForm();
      renderList(typeId);
    }

    // Archivace z√°znamu
    function archiveRecord(id) {
      let r = pronajimatele.find(x=>x.id===id);
      if (r) r.archivovano = true;
      renderList(r.typ);
    }

    // Maz√°n√≠ (pouze pokud nen√≠ propojen√≠)
    function deleteRecord(id) {
      // Zat√≠m v≈ædy povoleno, pozdƒõji p≈ôid√°me podm√≠nku
      pronajimatele = pronajimatele.filter(x=>x.id!==id);
      renderNav();
      $('#main').innerHTML = '';
    }

    renderNav();
    // V√Ωchoz√≠ pohled: Typ pronaj√≠matele Osoba
    showType("osoba");
  </script>
</body>
</html>
